import{g as v}from"./chrome-dev-DjaDa6xy.js";import{g as y}from"./strings-C9VxO2x6.js";chrome.runtime.onMessage.addListener(function(e,o,t){e.message&&e.message=="update_url"&&t({message:"update_url_permission"})});function L(){const e=document.getElementById("content")??document.body,o={subtree:!0,childList:!0},t=new MutationObserver(function(s,n){n.takeRecords(),n.disconnect(),b(),n.observe(e,o)});t.observe(e,o),location.href&&!location.href.includes("marktplaats")&&t.disconnect()}const B=v();L();async function b(){let e=!0;const o=m("hz-Button--small isActive");setTimeout(()=>{t()},0),setTimeout(()=>{t()},300);function t(){o&&o.forEach(n=>{const i=u("view-option-label",n);if(i){const r=i.innerHTML.replace(" ","");r.includes("Lijst")?e=!0:r.includes("Foto")||document.URL.includes("#view:gallery-view")?e=!1:document.URL.includes("#view:list-view")&&(e=!0)}})}setTimeout(async()=>{await s()},0);async function s(){if(e){const n=m("hz-Listing hz-Listing--list-item");n&&await g(n,!0)}else{const n=m("hz-Listing hz-Listing--gallery-item");n&&await g(n,!1)}}}async function g(e,o){const t=await B;if(e){let i=e.length;const r=[];e.forEach(l=>{n(l,t)&&r.push(l)}),r.forEach(l=>{var c;const a=l.nextElementSibling;l.style.display="none",(c=a==null?void 0:a.classList)!=null&&c.contains("hz-Listing--other-seller")&&a.remove(),i--}),i==e.length||i<1&&await E(o)}z();function s(i,r){const l=u("hz-Listing-seller-name-container",i);if(!l)return!1;const a=new MouseEvent("mouseover",{view:window,bubbles:!0,cancelable:!0}),c=l.querySelector("a");if(!c)return!1;c.dispatchEvent(a);const f=y(c.href);return r.some(d=>d.userId===f)}function n(i,r){const l=u("hz-Listing-priority",i);if(l){const f=l.querySelector("span");if(f){const d=f.innerHTML.trim(),p=!r.showDagtopper&&d==="Dagtopper",w=!r.showSponsored&&d==="Topadvertentie";if(p||w)return!0}}if(o&&(u("hz-Listing-seller-external-link",i)||!r.showBlockedSellers&&s(i,r.blockedSellers))||u("hz-Listing-Opvalsticker-wrapper",i))return!0;const c=u("hz-Listing-seller-link",i);if(!c)return!1;if(c.querySelector("a"))return!0}}function u(e,o){return o?o.getElementsByClassName(e)[0]??!1:document.getElementsByClassName(e)[0]??!1}function I(e){return document.getElementById(e)??!1}function m(e){return Array.from(document.getElementsByClassName(e))??!1}function z(){["hz-Listings__container--cas","hz-Listing hz-Listing--other-seller","hz-Listings__admarktTitle","ad ad-1","ad","hz-Banner","bannerContainerLoading","hz-Listings__container--casGallery"].forEach(t=>{const s=m(t);s&&s.forEach(n=>{n.style.display="none"})}),["adsense-container","ads","ftContainer","ad_unit"].forEach(t=>{const s=I(t);s&&(s.style.display="none")})}async function E(e){const o=/p\/([0-9]){1,5}/;let t=document.URL;if(!t)return;const s=t.match(o);if(!s)return;const n=(s==null?void 0:s.length)>0?s[s.length-1]:null;if(n){const r=(parseInt(n)+1).toString(),l=n.replace(/([0-9]){1,5}/,r),a=t.replace(n,l);await h(a)}else{t[t.length-1]=="/"&&(t=t.slice(0,-1));const i=`${t}/p/2/${e?"#view:list-view":"#view:gallery-view"}`;await h(i)}}async function h(e){await chrome.runtime.sendMessage({message:"update_url",newUrl:e})}export{b as removeAds};
